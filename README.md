# amira_image_cls

image tag web from data dir

this project use python3, keras and theano (not support tensorflow)

## data

download from https://pan.baidu.com/s/1mhCnI9i

select some cats and dogs to data/dog_vs_cat/

## run

```
python run.py
```

## docker run

use Dockerfile and set env, volume

## models

* copy densenet from https://raw.githubusercontent.com/titu1994/DenseNet/master/densenet.py
* keras official model zoo

## test output

simple cnn

```
Epoch 1/5
42/42 [==============================] - 94s - loss: 1.1062 - acc: 0.5829 - val_loss: 5.7632 - val_acc: 0.6371
Epoch 2/5
42/42 [==============================] - 93s - loss: 0.8723 - acc: 0.7091 - val_loss: 4.3352 - val_acc: 0.7154
Epoch 3/5
42/42 [==============================] - 92s - loss: 0.7825 - acc: 0.7430 - val_loss: 4.2651 - val_acc: 0.7311
Epoch 4/5
42/42 [==============================] - 92s - loss: 0.7132 - acc: 0.7687 - val_loss: 3.5350 - val_acc: 0.7807
Epoch 5/5
42/42 [==============================] - 91s - loss: 0.6068 - acc: 0.8115 - val_loss: 4.2563 - val_acc: 0.7285

```


alexnet

```
Epoch 1/5
42/42 [==============================] - 167s - loss: 1.2400 - acc: 0.6323 - val_loss: 5.5683 - val_acc: 0.6371
Epoch 2/5
42/42 [==============================] - 162s - loss: 1.0825 - acc: 0.6441 - val_loss: 5.7694 - val_acc: 0.6371
Epoch 3/5
42/42 [==============================] - 159s - loss: 1.1416 - acc: 0.6607 - val_loss: 4.2303 - val_acc: 0.6893
Epoch 4/5
42/42 [==============================] - 159s - loss: 0.9723 - acc: 0.6501 - val_loss: 5.5769 - val_acc: 0.6371
Epoch 5/5
42/42 [==============================] - 165s - loss: 0.9243 - acc: 0.6544 - val_loss: 4.3739 - val_acc: 0.7258

```

more data aug (range from 0.1 to 0.15), batch_size = 50, steps = cnt/batch_size + 20 and gpu test

gpu alexnet

```
Epoch 1/20
34/34 [==============================] - 12s - loss: 1.7664 - acc: 0.6360 - val_loss: 6.3016 - val_acc: 0.6031
Epoch 2/20
34/34 [==============================] - 10s - loss: 1.0782 - acc: 0.6817 - val_loss: 6.0933 - val_acc: 0.6031
Epoch 3/20
34/34 [==============================] - 10s - loss: 1.0306 - acc: 0.6775 - val_loss: 6.1309 - val_acc: 0.6031
Epoch 4/20
34/34 [==============================] - 10s - loss: 1.0102 - acc: 0.6523 - val_loss: 5.9001 - val_acc: 0.6031
Epoch 5/20
34/34 [==============================] - 10s - loss: 1.0307 - acc: 0.6791 - val_loss: 5.8498 - val_acc: 0.6371
Epoch 6/20
34/34 [==============================] - 10s - loss: 0.8763 - acc: 0.7025 - val_loss: 4.9505 - val_acc: 0.6893
Epoch 7/20
34/34 [==============================] - 10s - loss: 0.8216 - acc: 0.7334 - val_loss: 4.6606 - val_acc: 0.7076
Epoch 8/20
34/34 [==============================] - 10s - loss: 0.7105 - acc: 0.7541 - val_loss: 4.1849 - val_acc: 0.7363
Epoch 9/20
34/34 [==============================] - 10s - loss: 0.8813 - acc: 0.7259 - val_loss: 3.3034 - val_acc: 0.7937
Epoch 10/20
34/34 [==============================] - 11s - loss: 0.5691 - acc: 0.7837 - val_loss: 2.8777 - val_acc: 0.8198
Epoch 11/20
34/34 [==============================] - 10s - loss: 0.5688 - acc: 0.8043 - val_loss: 2.7529 - val_acc: 0.8198
Epoch 12/20
34/34 [==============================] - 10s - loss: 0.5118 - acc: 0.8160 - val_loss: 2.3495 - val_acc: 0.8512
Epoch 13/20
34/34 [==============================] - 10s - loss: 0.4560 - acc: 0.8461 - val_loss: 6.1010 - val_acc: 0.6162
Epoch 14/20
34/34 [==============================] - 10s - loss: 0.4480 - acc: 0.8441 - val_loss: 3.3065 - val_acc: 0.7937
Epoch 15/20
34/34 [==============================] - 11s - loss: 0.4147 - acc: 0.8594 - val_loss: 2.0107 - val_acc: 0.8747
Epoch 16/20
34/34 [==============================] - 10s - loss: 0.3752 - acc: 0.8875 - val_loss: 2.4765 - val_acc: 0.8407
Epoch 17/20
34/34 [==============================] - 10s - loss: 0.3903 - acc: 0.8729 - val_loss: 2.1915 - val_acc: 0.8616
Epoch 18/20
34/34 [==============================] - 10s - loss: 0.3521 - acc: 0.8771 - val_loss: 2.2132 - val_acc: 0.8616
Epoch 19/20
34/34 [==============================] - 10s - loss: 0.3796 - acc: 0.8883 - val_loss: 2.1463 - val_acc: 0.8668
Epoch 20/20
34/34 [==============================] - 10s - loss: 0.2982 - acc: 0.9096 - val_loss: 2.7313 - val_acc: 0.8225
```

gpu simple cnn

```
Epoch 1/20
34/34 [==============================] - 13s - loss: 1.0664 - acc: 0.6418 - val_loss: 5.3932 - val_acc: 0.6527
Epoch 2/20
34/34 [==============================] - 13s - loss: 0.8481 - acc: 0.7220 - val_loss: 5.4318 - val_acc: 0.6606
Epoch 3/20
34/34 [==============================] - 13s - loss: 0.8052 - acc: 0.7450 - val_loss: 4.7324 - val_acc: 0.7050
Epoch 4/20
34/34 [==============================] - 13s - loss: 0.6908 - acc: 0.7674 - val_loss: 4.8167 - val_acc: 0.6919
Epoch 5/20
34/34 [==============================] - 13s - loss: 0.6271 - acc: 0.7893 - val_loss: 4.9053 - val_acc: 0.6893
Epoch 6/20
34/34 [==============================] - 13s - loss: 0.6594 - acc: 0.7763 - val_loss: 4.2928 - val_acc: 0.7180
Epoch 7/20
34/34 [==============================] - 13s - loss: 0.5495 - acc: 0.8034 - val_loss: 4.5039 - val_acc: 0.7180
Epoch 8/20
34/34 [==============================] - 12s - loss: 0.5358 - acc: 0.8366 - val_loss: 4.3551 - val_acc: 0.7232
Epoch 9/20
34/34 [==============================] - 13s - loss: 0.4796 - acc: 0.8517 - val_loss: 3.3704 - val_acc: 0.7807
Epoch 10/20
34/34 [==============================] - 13s - loss: 0.4243 - acc: 0.8763 - val_loss: 3.0099 - val_acc: 0.8120
Epoch 11/20
34/34 [==============================] - 13s - loss: 0.3837 - acc: 0.8820 - val_loss: 2.8617 - val_acc: 0.8225
Epoch 12/20
34/34 [==============================] - 12s - loss: 0.3548 - acc: 0.8989 - val_loss: 3.3899 - val_acc: 0.7859
Epoch 13/20
34/34 [==============================] - 13s - loss: 0.3369 - acc: 0.9002 - val_loss: 4.9116 - val_acc: 0.6919
Epoch 14/20
34/34 [==============================] - 13s - loss: 0.3269 - acc: 0.9015 - val_loss: 2.7720 - val_acc: 0.8277
Epoch 15/20
34/34 [==============================] - 14s - loss: 0.3464 - acc: 0.8964 - val_loss: 4.8396 - val_acc: 0.6997
Epoch 16/20
34/34 [==============================] - 13s - loss: 0.2814 - acc: 0.9111 - val_loss: 3.1775 - val_acc: 0.7990
Epoch 17/20
34/34 [==============================] - 13s - loss: 0.2893 - acc: 0.9122 - val_loss: 3.6704 - val_acc: 0.7702
Epoch 18/20
34/34 [==============================] - 13s - loss: 0.2788 - acc: 0.9065 - val_loss: 3.5789 - val_acc: 0.7781
Epoch 19/20
34/34 [==============================] - 12s - loss: 0.2465 - acc: 0.9174 - val_loss: 3.6788 - val_acc: 0.7676
Epoch 20/20
34/34 [==============================] - 13s - loss: 0.2479 - acc: 0.9167 - val_loss: 3.2806 - val_acc: 0.7911
```
